{"_id":"1OeSautXitV2hN96","name":"Reset Virtues","type":"script","author":"KPVkkpR21c13yy2y","img":"modules/vyk-homebrew/assets/virtuousGuardian/virtues.png","scope":"global","command":"const UUID = \"Compendium.vyk-homebrew.virtuous-guardian.x9c695yty1uaFkiV\";\n\n(async () =>{\n    if(!actor){\n        ui.notifications.warn(\"You must have an actor selected\");\n        return;\n    } else{\n\n        let source = (await fromUuid(UUID)).toObject();\n        source.flags.core ?? {};\n        source.flags.core.sourceId = UUID;\n        \n        let cap = 1 + actor.data.data.abilities.cha.mod;\n        \n        if(actor.itemTypes.feat.filter(f=> f.name === \"Path of the Willbender\").length > 0){\n            cap = Math.floor(actor.data.data.abilities.cha.mod /2);\n        } \n        \n        const existing = actor.itemTypes.effect.find((effect) => effect.getFlag('core', 'sourceId') === UUID);\n        \n        if(existing){\n            await existing.delete();\n            \n            source.data.level.value = cap;\n            source.img = `modules/vyk-homebrew/assets/virtuousGuardian/virtues${Math.min(9,cap)}.png`;\n            \n            await actor.createEmbeddedDocuments('Item', [source]);\n            \n        } else{\n            source.data.level.value = cap;\n            source.img = `modules/vyk-homebrew/assets/virtuousGuardian/virtues${cap}.png`;\n            \n            await actor.createEmbeddedDocuments('Item', [source]);\n        }\n    }\n})();","folder":null,"sort":0,"permission":{"default":0,"KPVkkpR21c13yy2y":3},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.TCMThAWXA8zOdThI"}}}
{"name":"Decrease Virtues","type":"script","author":"KPVkkpR21c13yy2y","img":"modules/vyk-homebrew/assets/virtuousGuardian/virtuesSubstract.png","scope":"global","command":"const UUID = \"Compendium.vyk-homebrew.virtuous-guardian.x9c695yty1uaFkiV\";\n\n(async () =>{\n    if(!actor){\n        ui.notifications.warn(\"You must have an actor selected\");\n        return;\n    } else{\n        let source = (await fromUuid(UUID)).toObject();\n        source.flags.core ?? {};\n        source.flags.core.sourceId = UUID;\n        \n        console.log(source);\n        \n        const existing = actor.itemTypes.effect.find((effect) => effect.getFlag('core', 'sourceId') === UUID);\n        \n        if(existing){\n            \n            console.log(existing);\n            let virtues = existing.data.data.level.value;\n            \n            await existing.delete();\n            \n            if(virtues === 1) return;\n            \n            virtues--;\n            source.data.level.value = virtues;\n            source.img = `modules/vyk-homebrew/assets/virtuousGuardian/virtues${virtues}.png`;\n            \n            await actor.createEmbeddedDocuments('Item', [source]);\n            \n        } else{\n            ui.notifications.warn(`${actor.name} does not have any Virtues left!`);\n            return;\n        }\n    }\n})();","folder":null,"sort":0,"permission":{"default":0,"KPVkkpR21c13yy2y":3},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.hkasfFxQVRBarSyn"}},"_id":"SDA5bQcBrUkxs3pi"}
{"_id":"lxHX5ZCnO8xPbohB","name":"Increase Virtues","type":"script","author":"KPVkkpR21c13yy2y","img":"modules/vyk-homebrew/assets/virtuousGuardian/virtuesAdd.png","scope":"global","command":"const UUID = \"Compendium.vyk-homebrew.virtuous-guardian.x9c695yty1uaFkiV\";\n\n(async () =>{\n    if(!actor){\n        ui.notifications.warn(\"You must have an actor selected\");\n        return;\n    } else{\n\n        let source = (await fromUuid(UUID)).toObject();\n        source.flags.core ?? {};\n        source.flags.core.sourceId = UUID;\n        \n        let cap = 1 + actor.data.data.abilities.cha.mod;\n        \n        const existing = actor.itemTypes.effect.find((effect) => effect.getFlag('core', 'sourceId') === UUID);\n        \n        if(existing){\n            \n            let virtues = existing.data.data.level.value;\n            \n            if(virtues +1 > cap){\n                ui.notifications.warn(`${actor.name} is already at their capacity for Virtues!`);\n                return;\n            }\n            await existing.delete();\n           \n            virtues++;\n            \n            source.data.level.value = virtues;\n            source.img = `modules/vyk-homebrew/assets/virtuousGuardian/virtues${Math.min(9,virtues)}.png`;\n            \n            await actor.createEmbeddedDocuments('Item', [source]);\n            \n        } else{\n            source.data.level.value = 1;\n            source.img = `modules/vyk-homebrew/assets/virtuousGuardian/virtues1.png`;\n            \n            await actor.createEmbeddedDocuments('Item', [source]);\n        }\n    }\n})();","folder":null,"sort":0,"permission":{"default":0,"KPVkkpR21c13yy2y":3},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.2CHX191TJ3Ikifzb"}}}
{"name":"Reset Virtues","type":"script","author":"KPVkkpR21c13yy2y","img":"modules/vyk-homebrew/assets/virtuousGuardian/temp.png","scope":"global","command":"const UUID = \"Compendium.vyk-homebrew.virtuous-guardian.U34nOhwMHkl8t9R7\";\n\n(async () =>{\n    if(!actor){\n        ui.notifications.warn(\"You must have an actor selected\");\n        return;\n    } else{\n\n        let source = (await fromUuid(UUID)).toObject();\n        source.flags.core ?? {};\n        source.flags.core.sourceId = UUID;\n        \n        let cap = 3;\n        \n        const existing = actor.itemTypes.effect.find((effect) => effect.getFlag('core', 'sourceId') === UUID);\n        \n        if(existing){\n            await existing.delete();\n            \n            source.data.level.value = cap;\n            source.img = `modules/vyk-homebrew/assets/virtuousGuardian/temp${cap}.png`;\n            \n            await actor.createEmbeddedDocuments('Item', [source]);\n            \n        } else{\n            source.data.level.value = cap;\n            source.img = `modules/vyk-homebrew/assets/virtuousGuardian/temp${cap}.png`;\n            \n            await actor.createEmbeddedDocuments('Item', [source]);\n        }\n    }\n})();","folder":null,"sort":0,"permission":{"default":0,"KPVkkpR21c13yy2y":3},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.TCMThAWXA8zOdThI"}},"_id":"rEU4kY9EUI5i3k3p"}
{"name":"Decrease Temporary Virtues","type":"script","author":"KPVkkpR21c13yy2y","img":"modules/vyk-homebrew/assets/virtuousGuardian/tempSubstract.png","scope":"global","command":"const UUID = \"Compendium.vyk-homebrew.virtuous-guardian.U34nOhwMHkl8t9R7\";\n\n(async () =>{\n    if(!actor){\n        ui.notifications.warn(\"You must have an actor selected\");\n        return;\n    } else{\n        let source = (await fromUuid(UUID)).toObject();\n        source.flags.core ?? {};\n        source.flags.core.sourceId = UUID;\n        \n        console.log(source);\n        \n        const existing = actor.itemTypes.effect.find((effect) => effect.getFlag('core', 'sourceId') === UUID);\n        \n        if(existing){\n            \n            console.log(existing);\n            let virtues = existing.data.data.level.value;\n            \n            await existing.delete();\n            \n            if(virtues === 1) return;\n            \n            virtues--;\n            source.data.level.value = virtues;\n            source.img = `modules/vyk-homebrew/assets/virtuousGuardian/temp${virtues}.png`;\n            \n            await actor.createEmbeddedDocuments('Item', [source]);\n            \n        } else{\n            ui.notifications.warn(`${actor.name} does not have any Temporary Virtues left!`);\n            return;\n        }\n    }\n})();","folder":null,"sort":0,"permission":{"default":0,"KPVkkpR21c13yy2y":3},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.hkasfFxQVRBarSyn"}},"_id":"zfyx7yi7cO9caSkX"}
